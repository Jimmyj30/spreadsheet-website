<div fxLayout="column" fxLayoutGap="20px" class="container">
  <div class="vertical-margin">
    <hot-table
      #rawDataTableRef
      [hotId]="rawDataTableHandsontableID"
      [settings]="rawDataTableSettings"
    ></hot-table>
  </div>
  <div class="vertical-margin">
    <div>Curve straightening instructions for processed data table:</div>
    <div>(y: responding, x: manipulated)</div>
    <form
      [formGroup]="curveStraighteningInstructionsForm"
      (ngSubmit)="onSubmit()"
    >
      <!-- "y" curve straightening instructions -->
      <span>Plot </span>
      <select
        class="custom-select"
        (change)="changeYOption($event)"
        formControlName="yCurveStraighteningInstructions"
      >
        <option *ngFor="let option of yOptions" [ngValue]="option">
          {{ option }}
        </option>
      </select>
      <span class="left-margin" *ngIf="showYToConstantPower">a=</span>
      <input
        type="text"
        formControlName="yToConstantPower"
        *ngIf="showYToConstantPower"
        class="number-input"
        placeholder="eg: 1.23 or -5/3"
      />

      <span> as a function of </span>
      <!-- "x" curve straightening instructions -->
      <select
        class="custom-select"
        (change)="changeXOption($event)"
        formControlName="xCurveStraighteningInstructions"
      >
        <option *ngFor="let option of xOptions" [ngValue]="option">
          {{ option }}
        </option>
      </select>
      <span class="left-margin" *ngIf="showXToConstantPower">a=</span>
      <input
        type="text"
        formControlName="xToConstantPower"
        *ngIf="showXToConstantPower"
        class="number-input"
        placeholder="eg: 1.23 or -5/3"
      />
    </form>
  </div>
  <div class="vertical-margin">
    <div class="alert alert-danger error-message" *ngIf="error">
      <p>{{ error }}</p>
    </div>
    <button
      type="submit"
      (click)="onSubmit()"
      [disabled]="
        !curveStraighteningInstructionsForm.valid || invalidFormErrorMsg
      "
      class="btn"
    >
      Submit
    </button>
    <span class="left-margin" *ngIf="invalidFormErrorMsg"
      >{{ invalidFormErrorMsg }}
    </span>
  </div>
  <div *ngIf="loading" class="vertical-margin">
    <p>loading...</p>
    <mat-spinner></mat-spinner>
  </div>
  <div *ngIf="processedDataTable" class="vertical-margin">
    <hot-table
      #processedDataTableRef
      [hotId]="processedDataTableHandsontableID"
      [settings]="processedDataTableSettings"
    ></hot-table>
  </div>
  <app-graphs
    *ngIf="showGraph && processedDataTable"
    [processedDataTableData]="processedDataTableSettings.data"
  ></app-graphs>
  <div *ngIf="processedDataTable" fxLayout="column">
    <div>
      <!-- generate graph button will disappear once graph is generated -->
      <button type="button" (click)="onGenerateGraph()" *ngIf="!showGraph">
        Generate Graph
      </button>
    </div>
    <div><button type="button" (click)="onFinish()">Done</button></div>
  </div>
</div>
